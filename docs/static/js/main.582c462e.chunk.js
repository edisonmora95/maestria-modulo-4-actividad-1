(this["webpackJsonpactividad-1"]=this["webpackJsonpactividad-1"]||[]).push([[0],{46:function(e,t,n){},67:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(32),s=n.n(c),o=n(38),i=(n(46),n(40)),l=n(2),u=n.n(l),p=n(5),h=n(33),j=n(34),b=n(11),d=n(41),m=n(39),f=n(0),x=function(e){var t=e.onLogoClick,n=e.onProfileClick;return Object(f.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:Object(f.jsxs)("div",{className:"container-fluid",children:[Object(f.jsxs)("a",{className:"navbar-brand",href:"/",children:[Object(f.jsx)("i",{className:"bi-lightning-charge-fill"}),Object(f.jsx)("span",{onClick:t,children:"three pics"})]}),Object(f.jsx)("i",{className:"bi-person-circle",onClick:n})]})})},v=function(e){var t=e.onSearch,n=e.value,r=void 0===n?"":n,a=function(e){13===e.keyCode&&e.preventDefault()},c=function(e){t(e.target.value)};return Object(f.jsx)("form",{children:Object(f.jsx)("section",{className:"search-section",children:Object(f.jsx)("input",{onKeyDown:a,onChange:c,className:"form-control",value:r,type:"text",placeholder:"Search","aria-label":"default input example"})})})},O=n(13),g=n(22),k=n.n(g),y=n(35),w=n.n(y),N=n(10),C=n.n(N),L="https://three-points.herokuapp.com",P=function(){var e=Object(p.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(L).concat("/api/posts/"),e.next=4,C.a.get(t);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0.data));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(p.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(L,"/api/posts/").concat(t,"/like"),e.next=4,C.a.post(n);case 4:return r=e.sent,e.abrupt("return",r.data);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0.data));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();k.a.extend(w.a);var A=function(e){var t=e.img,n=void 0===t?"http://placeimg.com/640/480":t,a=e.createdAt,c=e.likes,s=e.author,o=e.description,i=e.comments,l=e.id,h=k()(a).fromNow(),j=Object(r.useState)(c),b=Object(O.a)(j,2),d=b[0],m=b[1],x=Object(r.useState)(!1),v=Object(O.a)(x,2),g=v[0],y=v[1],w=function(){var e=Object(p.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!g){e.next=5;break}return m(d-1),y(!1),e.abrupt("return");case 5:return m(d+1),y(!0),e.next=9,S(l);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),N=function(){return Object(f.jsx)("article",{className:"col-6",style:{textAlign:"left"},children:Object(f.jsx)("span",{children:h})})},C=function(){return Object(f.jsx)("article",{className:"col-6",style:{textAlign:"right"},children:Object(f.jsxs)("button",{type:"button",className:"btn btn-danger",onClick:w,children:[Object(f.jsx)("i",{className:"bi-heart"}),Object(f.jsx)("span",{style:{marginLeft:5},children:d})]})})};return Object(f.jsxs)("main",{className:"card",children:[Object(f.jsx)("img",{src:n,alt:"Logo"}),Object(f.jsxs)("section",{className:"card-body",children:[Object(f.jsxs)("section",{className:"row",children:[N(),C()]}),Object(f.jsx)("section",{style:{textAlign:"left"},className:"my-2",children:Object(f.jsx)("span",{style:{fontWeight:"bold"},children:s.name})}),Object(f.jsx)("section",{children:Object(f.jsx)("p",{className:"card-text",style:{textAlign:"justify"},children:o})}),Object(f.jsxs)("section",{style:{textAlign:"left"},className:"my-2",children:[Object(f.jsx)("i",{className:"bi-chat-right"}),Object(f.jsxs)("span",{style:{marginLeft:5},children:["Comments (",i,")"]})]})]})]})},I=function(e){var t=e.posts,n=void 0===t?[]:t;return Object(f.jsx)("section",{className:"row",children:n.map((function(e){return Object(f.jsx)("article",{className:"col-12 col-sm-6 col-md-4 my-2",children:Object(f.jsx)(A,{id:e.id,img:e.image,createdAt:e.createdAt,likes:e.likes,author:e.author,description:e.text,comments:e.comments.length})},"post=".concat(e.id))}))})},U=n(3),F=function(e){localStorage.setItem("userId",e)},D=function(){return localStorage.getItem("userId")},B=function(){localStorage.removeItem("userId")},M=function(){var e=Object(p.a)(u.a.mark((function e(t,n){var r,a,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="".concat(L).concat("/api/login"),a={username:t,password:n},e.next=5,C.a.post(r,a);case 5:return c=e.sent,s=c.data.id,F(void 0===s?"":s),e.abrupt("return",c.data);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0.data));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(p.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(L).concat("/api/users/").concat(t),e.next=4,C.a.get(n);case 4:return r=e.sent,e.abrupt("return",r.data);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0.data));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(L).concat("/api/logout"),e.next=4,C.a.post(t);case 4:return n=e.sent,B(),e.abrupt("return",n.data);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0.data));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),J=(n(67),function(e){var t=e.avatar,n=e.username,r=e.bio,a=e.onLogout,c=Object(U.f)(),s=function(){var e=Object(p.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E();case 3:c.push("/login"),a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)("main",{children:[Object(f.jsx)("section",{className:"my-3",children:Object(f.jsx)("img",{src:t,className:"avatar",alt:"avatar img"})}),Object(f.jsx)("section",{className:"my-3",children:Object(f.jsx)("span",{children:Object(f.jsx)("b",{children:n})})}),Object(f.jsx)("section",{className:"my-3 px-3",children:Object(f.jsx)("p",{children:r})}),Object(f.jsx)("section",{children:Object(f.jsx)("button",{onClick:s,type:"button",class:"btn btn-link",children:"Salir"})})]})}),T=n(19),K=(n(76),function(e){var t=e.onLoginComplete,n=Object(T.useState)(!1),r=Object(O.a)(n,2),a=r[0],c=r[1],s=Object(T.useState)(""),o=Object(O.a)(s,2),i=o[0],l=o[1],h=Object(T.useState)(!1),j=Object(O.a)(h,2),b=j[0],d=j[1],m=function(){var e=Object(p.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,d(!0),r=n.target.email.value,a=n.target.password.value,e.next=7,M(r,a);case 7:d(!1),c(!1),l(""),t(),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),d(!1),c(!0),l(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("main",{className:"row login-main",onSubmit:m,children:[a?Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:i}):null,Object(f.jsxs)("form",{className:"col-10 col-lg-4 col-md-4",children:[Object(f.jsxs)("section",{className:"mt-3",children:[Object(f.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),Object(f.jsx)("input",{type:"text",name:"email",className:"form-control",id:"email",placeholder:"name@example.com"})]}),Object(f.jsxs)("section",{className:"mt-3",children:[Object(f.jsx)("label",{htmlFor:"password",className:"form-label",children:"Password"}),Object(f.jsx)("input",{type:"password",name:"password",className:"form-control",id:"password"})]}),Object(f.jsx)("section",{className:"mt-3 d-grid gap-2",children:Object(f.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:"Login"})})]})]})});C.a.interceptors.response.use((function(e){return e}),(function(e){return e.response&&401===e.response.status&&(B(),window.location.replace("/login")),Promise.reject(e.response)}));n(77);var W=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).state={posts:[],searchValue:"",loadedPosts:!1,section:"posts",loginOk:!1,currentUser:{}},e.onSearch=e.onSearch.bind(Object(b.a)(e)),e.onProfileClick=e.onProfileClick.bind(Object(b.a)(e)),e.onLogoClick=e.onLogoClick.bind(Object(b.a)(e)),e.onLoginComplete=e.onLoginComplete.bind(Object(b.a)(e)),e.onLogout=e.onLogout.bind(Object(b.a)(e)),e}return Object(j.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=D())){e.next=15;break}return e.prev=2,e.next=5,this.getUser(t);case 5:this.props.history.push("/"),this.loadPosts(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),this.props.history.push("/login");case 13:e.next=16;break;case 15:this.props.history.push("/login");case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=Object(p.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:n=e.sent,this.setState({currentUser:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadPosts",value:function(){var e=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:t=e.sent,this.setState({posts:t,loadedPosts:!0});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLogout",value:function(){this.setState({currentUser:{}})}},{key:"onSearch",value:function(e){this.setState({searchValue:e})}},{key:"onProfileClick",value:function(){this.props.history.push("/profile")}},{key:"onLogoClick",value:function(){this.props.history.push("/")}},{key:"onLoginComplete",value:function(){var e=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=D())){e.next=15;break}return e.prev=2,e.next=5,this.getUser(t);case 5:this.props.history.push("/"),this.loadPosts(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),this.props.history.push("/login");case 13:e.next=16;break;case 15:this.props.history.push("/login");case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"renderNavbar",value:function(){return Object(f.jsx)(x,{onLogoClick:this.onLogoClick,onProfileClick:this.onProfileClick})}},{key:"renderSearchBar",value:function(){var e=this.state.searchValue;return Object(f.jsx)("section",{className:"row my-3",children:Object(f.jsx)("article",{className:"col-12",children:Object(f.jsx)(v,{onSearch:this.onSearch,value:e})})})}},{key:"renderPostList",value:function(){var e=this.state,t=e.posts,n=void 0===t?[]:t,r=e.searchValue,a=e.loadedPosts;if(!(void 0!==a&&a))return Object(f.jsx)("p",{children:"Loading..."});var c=Object(i.a)(n);return r&&(c=c.filter((function(e){return e.text.toLowerCase().includes(r.toLowerCase())}))),Object(f.jsx)(I,{posts:c})}},{key:"renderProfile",value:function(){var e=this.state.currentUser,t=(e=void 0===e?{}:e).avatar,n=e.username,r=e.bio;return Object(f.jsx)("section",{className:"row my-3",children:Object(f.jsx)(J,{avatar:t,username:n,bio:r,onLogout:this.onLogout})})}},{key:"renderMainContent",value:function(){return Object(f.jsx)("div",{children:Object(f.jsxs)(U.c,{children:[Object(f.jsx)(U.a,{path:"/login",children:Object(f.jsx)(K,{onLoginComplete:this.onLoginComplete})}),Object(f.jsx)(U.a,{path:"/profile",children:this.renderProfile()}),Object(f.jsx)(U.a,{path:"/",children:Object(f.jsxs)("div",{children:[this.renderSearchBar(),this.renderPostList()]})})]})})}},{key:"render",value:function(){return Object(f.jsxs)("main",{children:[Object(f.jsx)("header",{children:this.renderNavbar()}),Object(f.jsx)("main",{className:"App container",children:this.renderMainContent()})]})}}]),n}(r.Component),q=Object(U.g)(W),z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,79)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(o.a,{children:Object(f.jsx)(q,{})})}),document.getElementById("root")),z()}},[[78,1,2]]]);
//# sourceMappingURL=main.582c462e.chunk.js.map